# Modified script to remove specific instances 

$LogPath = "c:\logs\powershell\snaps\"
$LogFile = Get-Date -Format FileDateTimeUniversal
$TranscriptFileName = $LogPath + $LogFile +".txt"
 
# Start the transcript.
Start-Transcript -Path $TranscriptFileName
 
#Set the project.
$Project = "your  project id "
 
#Record the date / time that the snapshot cleanup started.
$StartTime = Get-Date
 
#Choose what snaps to remove. Essentially, the script takes the current date / time subtracts 30 days and sets a variable ($deletable). Is delatable even a word? Anyway... Any snaps older than that variable get removed. Obviously, you could tweak this number of days to fit your needs.
$deleteable = (Get-Date).AddDays(-1)
 
#Log what date and time we set $deleteable to.
Write-Host "Deleting snapshots older than:" $deleteable
 
#Delete the actual snaps.
$snapshots = Get-GceSnapshot
foreach ($snapshot in $snapshots) {
If($snapshot.Name -eq "instnace name 1"){
//do something
}
ElseIf($snapshot.Name -eq "sinstance name 2"){
//do something
}Else{
Remove-GceSnapshot $snapshot.Name
}
}

 
#Record the date / time that the snapshot cleanup ended.
$EndTime = Get-Date
 
#Print out the start and end times.
Write-Host "=========================================="
Write-Host "Started at:" $StartTime
Write-Host "Ended at:" $EndTime
Write-Host "=========================================="
 
#Stope the transcript.
Stop-Transcript



$LogPath = "c:\logs\powershell\snaps\"
$LogFile = Get-Date -Format FileDateTimeUniversal
$TranscriptFileName = $LogPath + $LogFile +".txt"

# Start the transcript.
Start-Transcript -Path $TranscriptFileName

#Set the GCP project.
$Project = "your project id "

#Set the zone(s) where the disks are that you would like to take snapshots of.
$Zones = "your zone "

#Record the date that the snapshots started.
$StartTime = Get-Date

#Go snapshot all of the disks in the zones identified above.
foreach ($Zone in $Zones) {
$DisksInZone = Get-GceDisk -Project $Project -zone $Zone | foreach { $_.Name }

    foreach ($Disk in $DisksInZone) {
        Write-Host "=========================================="
        Write-Host "$Zone "-" $Disk"
        Write-Host "=========================================="
        Add-GceSnapshot -project $Project -zone $Zone $Disk 
        }
}

#Record the date that the snapshots ended.
$EndTime = Get-Date

#Print out the start and end times.
Write-Host "=========================================="
Write-Host "Started at:" $StartTime
Write-Host "Ended at:" $EndTime
Write-Host "=========================================="

#Stope the transcript.
Stop-Transcript







